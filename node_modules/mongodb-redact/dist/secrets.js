"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SECRET_KIND = void 0;
exports.redactSecretsOnString = redactSecretsOnString;
const regexp_escape_1 = __importDefault(require("regexp.escape"));
exports.SECRET_KIND = [
    'base64',
    'private key',
    'user',
    'password',
    'email',
    'ip',
    'url',
    'mongodb uri',
];
function redactSecretsOnString(content, secrets) {
    let result = content;
    for (const { value, kind } of secrets) {
        if (!exports.SECRET_KIND.includes(kind)) {
            throw new Error(`Unknown secret kind ${kind}. Valid types: ${exports.SECRET_KIND.join(', ')}`);
        }
        const regex = new RegExp(`\\b${(0, regexp_escape_1.default)(value)}\\b`, 'g');
        result = result.replace(regex, `<${kind}>`);
    }
    return result;
}
//# sourceMappingURL=secrets.js.map